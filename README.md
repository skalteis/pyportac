Currently everything here is untested and likely does not work at all. WIP.